<!-- doc/src/sgml/ref/pg_restore.sgml -->

<refentry id="app-pgrestore">
<!--==========================orignal english content==========================
 <indexterm zone="app-pgrestore">
  <primary>pg_restore</primary>
 </indexterm>
____________________________________________________________________________-->
 <indexterm zone="app-pgrestore">
  <primary>pg_restore</primary>
 </indexterm>

<!--==========================orignal english content==========================
 <refmeta>
  <refentrytitle>pg_restore</refentrytitle>
  <manvolnum>1</manvolnum>
  <refmiscinfo>Application</refmiscinfo>
 </refmeta>
____________________________________________________________________________-->
 <refmeta>
  <refentrytitle>pg_restore</refentrytitle>
  <manvolnum>1</manvolnum>
  <refmiscinfo>Application</refmiscinfo>
 </refmeta>

<!--==========================orignal english content==========================
 <refnamediv>
  <refname>pg_restore</refname>

  <refpurpose>
   restore a <productname>PostgreSQL</productname> database from an
   archive file created by <application>pg_dump</application>
  </refpurpose>
 </refnamediv>
____________________________________________________________________________-->
 <refnamediv>
  <refname>pg_restore</refname>

  <refpurpose>
   从一个由<application>pg_dump</application>创建的归档文件恢复一个<productname>PostgreSQL</productname>数据库
  </refpurpose>
 </refnamediv>

 <refsynopsisdiv>
<!--==========================orignal english content==========================
  <cmdsynopsis>
   <command>pg_restore</command>
   <arg rep="repeat"><replaceable>connection-option</replaceable></arg>
   <arg rep="repeat"><replaceable>option</replaceable></arg>
   <arg choice="opt"><replaceable>filename</replaceable></arg>
  </cmdsynopsis>
____________________________________________________________________________-->
  <cmdsynopsis>
   <command>pg_restore</command>
   <arg rep="repeat"><replaceable>connection-option</replaceable></arg>
   <arg rep="repeat"><replaceable>option</replaceable></arg>
   <arg choice="opt"><replaceable>filename</replaceable></arg>
  </cmdsynopsis>
 </refsynopsisdiv>


 <refsect1 id="app-pgrestore-description">
<!--==========================orignal english content==========================
  <title>Description</title>
____________________________________________________________________________-->
  <title>描述</title>

<!--==========================orignal english content==========================
  <para>
   <application>pg_restore</application> is a utility for restoring a
   <productname>PostgreSQL</productname> database from an archive
   created by <xref linkend="app-pgdump"/> in one of the non-plain-text
   formats.  It will issue the commands necessary to reconstruct the
   database to the state it was in at the time it was saved.  The
   archive files also allow <application>pg_restore</application> to
   be selective about what is restored, or even to reorder the items
   prior to being restored. The archive files are designed to be
   portable across architectures.
  </para>
____________________________________________________________________________-->
  <para>
   <application>pg_restore</application>是一个用来从<xref linkend="app-pgdump"/>创建的非文本格式归档恢复<productname>PostgreSQL</productname>数据库的工具。它将发出必要的命令把该数据库重建成它被保存时的状态。这些归档文件还允许<application>pg_restore</application>选择恢复哪些内容或者在恢复前对恢复项重排序。这些归档文件被设计为可以在不同的架构之间迁移。
  </para>

<!--==========================orignal english content==========================
  <para>
   <application>pg_restore</application> can operate in two modes.
   If a database name is specified, <application>pg_restore</application>
   connects to that database and restores archive contents directly into
   the database.  Otherwise, a script containing the SQL
   commands necessary to rebuild the database is created and written
   to a file or standard output.  This script output is equivalent to
   the plain text output format of <application>pg_dump</application>.
   Some of the options controlling the output are therefore analogous to
   <application>pg_dump</application> options.
  </para>
____________________________________________________________________________-->
  <para>
   <application>pg_restore</application>可以在两种模式下操作。如果指定了一个数据库名称，<application>pg_restore</application>会连接那个数据库并且把归档内容直接恢复到该数据库中。否则，会创建一个脚本，其中包含着重建该数据库所必要的 SQL 命令，它会被写入到一个文件或者标准输出。这个脚本输出等效于<application>pg_dump</application>的纯文本输出格式。因此，一些控制输出的选项与<application>pg_dump</application>的选项类似。
  </para>

<!--==========================orignal english content==========================
  <para>
   Obviously, <application>pg_restore</application> cannot restore information
   that is not present in the archive file.  For instance, if the
   archive was made using the <quote>dump data as
   <command>INSERT</command> commands</quote> option,
   <application>pg_restore</application> will not be able to load the data
   using <command>COPY</command> statements.
  </para>
____________________________________________________________________________-->
  <para>
   显然，<application>pg_restore</application>无法恢复不在归档文件中的信息。例如，如果归档使用<quote>以<command>INSERT</command>命令转储数据</quote>选项创建， <application>pg_restore</application>将无法使用<command>COPY</command>语句装载数据。
  </para>
 </refsect1>

 <refsect1 id="app-pgrestore-options">
<!--==========================orignal english content==========================
  <title>Options</title>
____________________________________________________________________________-->
  <title>选项</title>

<!--==========================orignal english content==========================
   <para>
    <application>pg_restore</application> accepts the following command
    line arguments.

    <variablelist>
     <varlistentry>
      <term><replaceable class="parameter">filename</replaceable></term>
      <listitem>
       <para>
       Specifies the location of the archive file (or directory, for a
       directory-format archive) to be restored.
       If not specified, the standard input is used.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-a</option></term>
      <term><option>-&minus;data-only</option></term>
      <listitem>
       <para>
        Restore only the data, not the schema (data definitions).
        Table data, large objects, and sequence values are restored,
        if present in the archive.
       </para>

       <para>
        This option is similar to, but for historical reasons not identical
        to, specifying <option>-&minus;section=data</option>.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-c</option></term>
      <term><option>-&minus;clean</option></term>
      <listitem>
       <para>
        Clean (drop) database objects before recreating them.
        (Unless <option>-&minus;if-exists</option> is used,
        this might generate some harmless error messages, if any objects
        were not present in the destination database.)
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-C</option></term>
      <term><option>-&minus;create</option></term>
      <listitem>
       <para>
        Create the database before restoring into it.
        If <option>-&minus;clean</option> is also specified, drop and
        recreate the target database before connecting to it.
       </para>

       <para>
        With <option>-&minus;create</option>, <application>pg_restore</application>
        also restores the database's comment if any, and any configuration
        variable settings that are specific to this database, that is,
        any <command>ALTER DATABASE ... SET ...</command>
        and <command>ALTER ROLE ... IN DATABASE ... SET ...</command>
        commands that mention this database.
        Access privileges for the database itself are also restored,
        unless <option>-&minus;no-acl</option> is specified.
       </para>

       <para>
        When this option is used, the database named with <option>-d</option>
        is used only to issue the initial <command>DROP DATABASE</command> and
        <command>CREATE DATABASE</command> commands.  All data is restored into the
        database name that appears in the archive.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-d <replaceable class="parameter">dbname</replaceable></option></term>
      <term><option>-&minus;dbname=<replaceable class="parameter">dbname</replaceable></option></term>
      <listitem>
       <para>
        Connect to database <replaceable
        class="parameter">dbname</replaceable> and restore directly
        into the database.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-e</option></term>
      <term><option>-&minus;exit-on-error</option></term>
      <listitem>
       <para>
        Exit if an error is encountered while sending SQL commands to
        the database. The default is to continue and to display a count of
        errors at the end of the restoration.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-f <replaceable>filename</replaceable></option></term>
      <term><option>-&minus;file=<replaceable>filename</replaceable></option></term>
      <listitem>
       <para>
        Specify output file for generated script, or for the listing
        when used with <option>-l</option>. Default is the standard
        output.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-F <replaceable class="parameter">format</replaceable></option></term>
      <term><option>-&minus;format=<replaceable class="parameter">format</replaceable></option></term>
      <listitem>
       <para>
        Specify format of the archive.  It is not necessary to specify
        the format, since <application>pg_restore</application> will
        determine the format automatically. If specified, it can be
        one of the following:

       <variablelist>
        <varlistentry>
         <term><literal>c</literal></term>
         <term><literal>custom</literal></term>
         <listitem>
          <para>
           The archive is in the custom format of
           <application>pg_dump</application>.
          </para>
         </listitem>
        </varlistentry>

        <varlistentry>
         <term><literal>d</literal></term>
         <term><literal>directory</literal></term>
         <listitem>
          <para>
           The archive is a directory archive.
          </para>
         </listitem>
        </varlistentry>

        <varlistentry>
         <term><literal>t</literal></term>
         <term><literal>tar</literal></term>
         <listitem>
          <para>
           The archive is a <command>tar</command> archive.
          </para>
         </listitem>
        </varlistentry>
       </variablelist></para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-I <replaceable class="parameter">index</replaceable></option></term>
      <term><option>-&minus;index=<replaceable class="parameter">index</replaceable></option></term>
      <listitem>
       <para>
        Restore definition of named index only.  Multiple indexes
        may be specified with multiple <option>-I</option> switches.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-j <replaceable class="parameter">number-of-jobs</replaceable></option></term>
      <term><option>-&minus;jobs=<replaceable class="parameter">number-of-jobs</replaceable></option></term>
      <listitem>
       <para>
        Run the most time-consuming parts
        of <application>pg_restore</application> &mdash; those which load data,
        create indexes, or create constraints &mdash; using multiple
        concurrent jobs.  This option can dramatically reduce the time
        to restore a large database to a server running on a
        multiprocessor machine.
       </para>

       <para>
        Each job is one process or one thread, depending on the
        operating system, and uses a separate connection to the
        server.
       </para>

       <para>
        The optimal value for this option depends on the hardware
        setup of the server, of the client, and of the network.
        Factors include the number of CPU cores and the disk setup.  A
        good place to start is the number of CPU cores on the server,
        but values larger than that can also lead to faster restore
        times in many cases.  Of course, values that are too high will
        lead to decreased performance because of thrashing.
       </para>

       <para>
        Only the custom and directory archive formats are supported
        with this option.
        The input must be a regular file or directory (not, for example, a
        pipe).  This option is ignored when emitting a script rather
        than connecting directly to a database server.  Also, multiple
        jobs cannot be used together with the
        option <option>-&minus;single-transaction</option>.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-l</option></term>
      <term><option>-&minus;list</option></term>
      <listitem>
       <para>
        List the table of contents of the archive. The output of this operation
        can be used as input to the <option>-L</option> option.  Note that
        if filtering switches such as <option>-n</option> or <option>-t</option> are
        used with <option>-l</option>, they will restrict the items listed.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-L <replaceable class="parameter">list-file</replaceable></option></term>
      <term><option>-&minus;use-list=<replaceable class="parameter">list-file</replaceable></option></term>
      <listitem>
       <para>
        Restore only those archive elements that are listed in <replaceable
        class="parameter">list-file</replaceable>, and restore them in the
        order they appear in the file.  Note that
        if filtering switches such as <option>-n</option> or <option>-t</option> are
        used with <option>-L</option>, they will further restrict the items restored.
       </para>
       <para><replaceable class="parameter">list-file</replaceable> is normally created by
        editing the output of a previous <option>-l</option> operation.
        Lines can be moved or removed, and can also
        be commented out by placing a semicolon (<literal>;</literal>) at the
        start of the line.  See below for examples.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-n <replaceable class="parameter">schema</replaceable></option></term>
      <term><option>-&minus;schema=<replaceable class="parameter">schema</replaceable></option></term>
      <listitem>
       <para>
        Restore only objects that are in the named schema.  Multiple schemas
        may be specified with multiple <option>-n</option> switches.  This can be
        combined with the <option>-t</option> option to restore just a
        specific table.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-N <replaceable class="parameter">schema</replaceable></option></term>
      <term><option>-&minus;exclude-schema=<replaceable class="parameter">schema</replaceable></option></term>
      <listitem>
       <para>
        Do not restore objects that are in the named schema.  Multiple schemas
        to be excluded may be specified with multiple <option>-N</option> switches.
       </para>

       <para>
        When both <option>-n</option> and <option>-N</option> are given for the same
        schema name, the <option>-N</option> switch wins and the schema is excluded.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-O</option></term>
      <term><option>-&minus;no-owner</option></term>
      <listitem>
       <para>
        Do not output commands to set
        ownership of objects to match the original database.
        By default, <application>pg_restore</application> issues
        <command>ALTER OWNER</command> or
        <command>SET SESSION AUTHORIZATION</command>
        statements to set ownership of created schema elements.
        These statements will fail unless the initial connection to the
        database is made by a superuser
        (or the same user that owns all of the objects in the script).
        With <option>-O</option>, any user name can be used for the
        initial connection, and this user will own all the created objects.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-P <replaceable class="parameter">function-name(argtype [, ...])</replaceable></option></term>
      <term><option>-&minus;function=<replaceable class="parameter">function-name(argtype [, ...])</replaceable></option></term>
      <listitem>
       <para>
        Restore the named function only.  Be careful to spell the function
        name and arguments exactly as they appear in the dump file's table
        of contents.  Multiple functions may be specified with multiple
        <option>-P</option> switches.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-R</option></term>
      <term><option>-&minus;no-reconnect</option></term>
      <listitem>
       <para>
        This option is obsolete but still accepted for backwards
        compatibility.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-s</option></term>
      <term><option>-&minus;schema-only</option></term>
      <listitem>
       <para>
        Restore only the schema (data definitions), not data,
        to the extent that schema entries are present in the archive.
       </para>
       <para>
        This option is the inverse of <option>-&minus;data-only</option>.
        It is similar to, but for historical reasons not identical to,
        specifying
        <option>-&minus;section=pre-data -&minus;section=post-data</option>.
       </para>
       <para>
        (Do not confuse this with the <option>-&minus;schema</option> option, which
        uses the word <quote>schema</quote> in a different meaning.)
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-S <replaceable class="parameter">username</replaceable></option></term>
      <term><option>-&minus;superuser=<replaceable class="parameter">username</replaceable></option></term>
      <listitem>
       <para>
        Specify the superuser user name to use when disabling triggers.
        This is relevant only if <option>-&minus;disable-triggers</option> is used.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-t <replaceable class="parameter">table</replaceable></option></term>
      <term><option>-&minus;table=<replaceable class="parameter">table</replaceable></option></term>
      <listitem>
       <para>
        Restore definition and/or data of only the named table.
        For this purpose, <quote>table</quote> includes views, materialized views,
        sequences, and foreign tables.  Multiple tables
        can be selected by writing multiple <option>-t</option> switches.
        This option can be combined with the <option>-n</option> option to
        specify table(s) in a particular schema.
       </para>

       <note>
        <para>
         When <option>-t</option> is specified, <application>pg_restore</application>
         makes no attempt to restore any other database objects that the
         selected table(s) might depend upon.  Therefore, there is no
         guarantee that a specific-table restore into a clean database will
         succeed.
        </para>
       </note>

       <note>
        <para>
         This flag does not behave identically to the <option>-t</option>
         flag of <application>pg_dump</application>.  There is not currently
         any provision for wild-card matching in <application>pg_restore</application>,
         nor can you include a schema name within its <option>-t</option>.
         And, while <application>pg_dump</application>'s <option>-t</option>
         flag will also dump subsidiary objects (such as indexes) of the
         selected table(s),
         <application>pg_restore</application>'s <option>-t</option>
         flag does not include such subsidiary objects.
        </para>
       </note>

       <note>
        <para>
         In versions prior to <productname>PostgreSQL</productname> 9.6, this flag
         matched only tables, not any other type of relation.
        </para>
       </note>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-T <replaceable class="parameter">trigger</replaceable></option></term>
      <term><option>-&minus;trigger=<replaceable class="parameter">trigger</replaceable></option></term>
      <listitem>
       <para>
        Restore named trigger only.  Multiple triggers may be specified with
        multiple <option>-T</option> switches.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-v</option></term>
      <term><option>-&minus;verbose</option></term>
      <listitem>
       <para>
        Specifies verbose mode.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
       <term><option>-V</option></term>
       <term><option>-&minus;version</option></term>
       <listitem>
       <para>
       Print the <application>pg_restore</application> version and exit.
       </para>
       </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-x</option></term>
      <term><option>-&minus;no-privileges</option></term>
      <term><option>-&minus;no-acl</option></term>
      <listitem>
       <para>
        Prevent restoration of access privileges (grant/revoke commands).
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-1</option></term>
      <term><option>-&minus;single-transaction</option></term>
      <listitem>
       <para>
        Execute the restore as a single transaction (that is, wrap the
        emitted commands in <command>BEGIN</command>/<command>COMMIT</command>).  This
        ensures that either all the commands complete successfully, or no
        changes are applied. This option implies
        <option>-&minus;exit-on-error</option>.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-&minus;disable-triggers</option></term>
      <listitem>
       <para>
        This option is relevant only when performing a data-only restore.
        It instructs <application>pg_restore</application> to execute commands
        to temporarily disable triggers on the target tables while
        the data is reloaded.  Use this if you have referential
        integrity checks or other triggers on the tables that you
        do not want to invoke during data reload.
       </para>

       <para>
        Presently, the commands emitted for
        <option>-&minus;disable-triggers</option> must be done as superuser.  So you
        should also specify a superuser name with <option>-S</option> or,
        preferably, run <application>pg_restore</application> as a
        <productname>PostgreSQL</productname> superuser.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-&minus;enable-row-security</option></term>
      <listitem>
       <para>
        This option is relevant only when restoring the contents of a table
        which has row security.  By default, <application>pg_restore</application> will set
        <xref linkend="guc-row-security"/> to off, to ensure
        that all data is restored in to the table.  If the user does not have
        sufficient privileges to bypass row security, then an error is thrown.
        This parameter instructs <application>pg_restore</application> to set
        <xref linkend="guc-row-security"/> to on instead, allowing the user to attempt to restore
        the contents of the table with row security enabled.  This might still
        fail if the user does not have the right to insert the rows from the
        dump into the table.
       </para>

       <para>
        Note that this option currently also requires the dump be in <command>INSERT</command>
        format, as <command>COPY FROM</command> does not support row security.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-&minus;if-exists</option></term>
      <listitem>
       <para>
        Use conditional commands (i.e. add an <literal>IF EXISTS</literal>
        clause) to drop database objects.  This option is not valid
        unless <option>-&minus;clean</option> is also specified.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-&minus;no-comments</option></term>
      <listitem>
       <para>
        Do not output commands to restore comments, even if the archive
        contains them.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-&minus;no-data-for-failed-tables</option></term>
      <listitem>
       <para>
        By default, table data is restored even if the creation command
        for the table failed (e.g., because it already exists).
        With this option, data for such a table is skipped.
        This behavior is useful if the target database already
        contains the desired table contents.  For example,
        auxiliary tables for <productname>PostgreSQL</productname> extensions
        such as <productname>PostGIS</productname> might already be loaded in
        the target database; specifying this option prevents duplicate
        or obsolete data from being loaded into them.
       </para>

       <para>
        This option is effective only when restoring directly into a
        database, not when producing SQL script output.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-&minus;no-publications</option></term>
      <listitem>
       <para>
        Do not output commands to restore publications, even if the archive
        contains them.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-&minus;no-security-labels</option></term>
      <listitem>
       <para>
        Do not output commands to restore security labels,
        even if the archive contains them.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-&minus;no-subscriptions</option></term>
      <listitem>
       <para>
        Do not output commands to restore subscriptions, even if the archive
        contains them.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-&minus;no-tablespaces</option></term>
      <listitem>
       <para>
        Do not output commands to select tablespaces.
        With this option, all objects will be created in whichever
        tablespace is the default during restore.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
       <term><option>-&minus;section=<replaceable class="parameter">sectionname</replaceable></option></term>
       <listitem>
         <para>
          Only restore the named section. The section name can be
          <option>pre-data</option>, <option>data</option>, or <option>post-data</option>.
          This option can be specified more than once to select multiple
          sections. The default is to restore all sections.
         </para>
         <para>
          The data section contains actual table data as well as large-object
          definitions.
          Post-data items consist of definitions of indexes, triggers, rules
          and constraints other than validated check constraints.
          Pre-data items consist of all other data definition items.
         </para>
       </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-&minus;strict-names</option></term>
      <listitem>
       <para>
        Require that each schema
        (<option>-n</option>/<option>-&minus;schema</option>) and table
        (<option>-t</option>/<option>-&minus;table</option>) qualifier match at
        least one schema/table in the backup file.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-&minus;use-set-session-authorization</option></term>
      <listitem>
       <para>
        Output SQL-standard <command>SET SESSION AUTHORIZATION</command> commands
        instead of <command>ALTER OWNER</command> commands to determine object
        ownership.  This makes the dump more standards-compatible, but
        depending on the history of the objects in the dump, might not restore
        properly.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
       <term><option>-?</option></term>
       <term><option>-&minus;help</option></term>
       <listitem>
       <para>
       Show help about <application>pg_restore</application> command line
       arguments, and exit.
       </para>
       </listitem>
     </varlistentry>

    </variablelist>
   </para>
____________________________________________________________________________-->
   <para>
    <application>pg_restore</application>接受下列命令行参数。

    <variablelist>
     <varlistentry>
      <term><replaceable class="parameter">filename</replaceable></term>
      <listitem>
       <para>
       指定要被恢复的归档文件（对于一个目录格式的归档则是目录）的位置。如果没有指定，则使用标准输入。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-a</option></term>
      <term><option>--data-only</option></term>
      <listitem>
       <para>
        只恢复数据，不恢复模式（数据定义）。如果在归档中存在，表数据、大对象和序列值会被恢复。
       </para>

       <para>
        这个选项类似于指定<option>--section=data</option>，但是由于历史原因两者不完全相同。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-c</option></term>
      <term><option>--clean</option></term>
      <listitem>
       <para>
        在重新创建数据库对象之前清除（丢弃）它们（除非使用了<option>--if-exists</option>，如果有对象在目标数据库中不存在，这可能会生成一些无害的错误消息）。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-C</option></term>
      <term><option>--create</option></term>
      <listitem>
       <para>
        在恢复一个数据库之前县创建它。如果还指定了<option>--clean</option>，在连接到目标数据库之前丢弃并且重建它。
       </para>

       <para>
        如果使用<option>--create</option>，<application>pg_restore</application>还会恢复数据库的注释（如果有）以及与其相关的配置变量设置，也就是任何提到过这个数据库的<command>ALTER DATABASE ... SET ...</command>和<command>ALTER ROLE ... IN DATABASE ... SET ...</command>命令。不管是否指定<option>--no-acl</option>，数据库本身的访问特权都会被恢复。
       </para>

       <para>
        在使用这个选项时，<option>-d</option>提到的数据库只被用于发出初始的<command>DROP DATABASE</command>和<command>CREATE DATABASE</command>命令。所有要恢复到该数据库名中的数据都出现在归档中。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-d <replaceable class="parameter">dbname</replaceable></option></term>
      <term><option>--dbname=<replaceable class="parameter">dbname</replaceable></option></term>
      <listitem>
       <para>
        连接到数据库<replaceable class="parameter">dbname</replaceable>并且直接恢复到该数据库中。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-e</option></term>
      <term><option>--exit-on-error</option></term>
      <listitem>
       <para>
        在发送 SQL 命令到该数据库期间如果碰到一个错误就退出。默认行为是继续并且在恢复结束时显示一个错误计数。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-f <replaceable>filename</replaceable></option></term>
      <term><option>--file=<replaceable>filename</replaceable></option></term>
      <listitem>
       <para>
        为生成的脚本或列表（当使用<option>-l</option>时）指定输出文件。默认是标准输出。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-F <replaceable class="parameter">format</replaceable></option></term>
      <term><option>--format=<replaceable class="parameter">format</replaceable></option></term>
      <listitem>
       <para>
        指定归档的格式。并不一定要指定该格式，因为<application>pg_restore</application>将会自动决定格式。如果指定，可以是下列之一：

       <variablelist>
        <varlistentry>
         <term><literal>c</literal></term>
         <term><literal>custom</literal></term>
         <listitem>
          <para>
           归档是<application>pg_dump</application>的自定义格式。
          </para>
         </listitem>
        </varlistentry>

        <varlistentry>
         <term><literal>d</literal></term>
         <term><literal>directory</literal></term>
         <listitem>
          <para>
           归档是一个目录归档。
          </para>
         </listitem>
        </varlistentry>

        <varlistentry>
         <term><literal>t</literal></term>
         <term><literal>tar</literal></term>
         <listitem>
          <para>
           归档是一个<command>tar</command>归档。
          </para>
         </listitem>
        </varlistentry>
       </variablelist></para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-I <replaceable class="parameter">index</replaceable></option></term>
      <term><option>--index=<replaceable class="parameter">index</replaceable></option></term>
      <listitem>
       <para>
        只恢复提及的索引的定义。可以通过写多个<option>-I</option>开关指定多个索引。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-j <replaceable class="parameter">number-of-jobs</replaceable></option></term>
      <term><option>--jobs=<replaceable class="parameter">number-of-jobs</replaceable></option></term>
      <listitem>
       <para>
        使用并发任务运行<application>pg_restore</application>中最耗时的部分 &mdash; 载入数据、创建索引或者创建约束。对于一个运行在多处理器机器上的服务器，这个选项能够大幅度减少恢复一个大型数据库的时间。
       </para>

       <para>
        每一个任务是一个进程或者一个线程，这取决于操作系统，它们都使用一个独立的服务器连接。
       </para>

       <para>
        这个选项的最佳值取决于服务器、客户端以及网络的硬件设置。因素包括 CPU 的核心数和磁盘设置。一个好的建议是服务器上 CPU 的核心数，但是更大的值在很多情况下也能导致更快的恢复时间。当然，过高的值会由于超负荷反而导致性能降低。
       </para>

       <para>
        这个选项只支持自定义和目录归档格式。输入必须是一个常规文件或目录（例如，不能是一个管道）。当发出一个脚本而不是直接连接到数据库服务器时会忽略这个选项。还有，多任务不能和选项<option>--single-transaction</option>一起用。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-l</option></term>
      <term><option>--list</option></term>
      <listitem>
       <para>
        列出归档的内容的表格。这个操作的输出能被用作<option>-L</option>选项的输入。注意如果把<option>-n</option>或<option>-t</option>这样的过滤开关与<option>-l</option>一起使用，它们将会限制列出的项。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-L <replaceable class="parameter">list-file</replaceable></option></term>
      <term><option>--use-list=<replaceable class="parameter">list-file</replaceable></option></term>
      <listitem>
       <para>
        只恢复在<replaceable class="parameter">list-file</replaceable>中列出的归档元素，并且按照它们出现在该文件中的顺序进行恢复。注意如果把<option>-n</option>或<option>-t</option>这样的过滤开关与<option>-L</option>一起使用，它们将会进一步限制要恢复的项。
       </para>
       <para><replaceable class="parameter">list-file</replaceable>通常是编辑一个<option>-l</option>操作的输出来创建。行可以被移动或者移除，并且也可以通过在行首放一个（<literal>;</literal>）将其注释掉。例子见下文。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-n <replaceable class="parameter">shcema</replaceable></option></term>
      <term><option>--schema=<replaceable class="parameter">schema</replaceable></option></term>
      <listitem>
       <para>
        只恢复在被提及的模式中的对象。可以用多个<option>-n</option>开关来指定多个模式。这可以与<option>-t</option>选项组合在一起只恢复一个指定的表。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-N <replaceable class="parameter">schema</replaceable></option></term>
      <term><option>--exclude-schema=<replaceable class="parameter">schema</replaceable></option></term>
      <listitem>
       <para>
        不恢复所提及方案中的对象。可以用多个<option>-N</option>开关指定多个要被排除的方案。
       </para>

       <para>
        如果对同一个方案名称同时给出了<option>-n</option>和<option>-N</option>，则<option>-N</option>会胜出并且该方案会被排除。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-O</option></term>
      <term><option>--no-owner</option></term>
      <listitem>
       <para>
        不要输出将对象的所有权设置为与原始数据库匹配的命令。默认情况下，<application>pg_restore</application>会发出<command>ALTER OWNER</command>或者<command>SET SESSION AUTHORIZATION</command>语句来设置已创建的模式对象的所有权。除非到该数据库的初始连接是一个超级用户（或者拥有脚本中所有对象的同一个用户）建立的，这些语句将会失败。通过<option>-O</option>，任何用户名都可以被用于初始连接，并且这个用户将会拥有所有被创建的对象。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-P <replaceable class="parameter">function-name(argtype [, ...])</replaceable></option></term>
      <term><option>--function=<replaceable class="parameter">function-name(argtype [, ...])</replaceable></option></term>
      <listitem>
       <para>
        只恢复被提及的函数。要小心地拼写函数的名称和参数使它们正好就是出现在转储文件的内容表中的名称和参数。可以使用多个<option>-P</option>开关指定多个函数。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-R</option></term>
      <term><option>--no-reconnect</option></term>
      <listitem>
       <para>
        这个选项已被废弃，但是出于向后兼容性的目的，系统仍然还接受它。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-s</option></term>
      <term><option>--schema-only</option></term>
      <listitem>
       <para>
        只恢复归档中的模式（数据定义）不恢复数据。
       </para>
       <para>
        这个选项是<option>--data-only</option>的逆选项。它与指定<option>--section=pre-data --section=post-data</option>相似，但是由于历史原因并不完全相同。
       </para>
       <para>
        （不要把这个选项和<option>--schema</option>选项弄混，后者把词<quote>schema</quote>用于一种不同的含义）。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-S <replaceable class="parameter">username</replaceable></option></term>
      <term><option>--superuser=<replaceable class="parameter">username</replaceable></option></term>
      <listitem>
       <para>
        指定在禁用触发器时要用的超级用户名。只有使用<option>--disable-triggers</option>时这个选项才相关。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-t <replaceable class="parameter">table</replaceable></option></term>
      <term><option>--table=<replaceable class="parameter">table</replaceable></option></term>
      <listitem>
       <para>
        只恢复所提及的表的定义和数据。出于这个目的，<quote>table</quote>包括视图、物化视图、序列和外部表。可以写上多个<option>-t</option>开关可以选择多个表。这个选项可以和<option>-n</option>选项结合在一起指定一个特定模式中的表。
       </para>
       
       <note>
        <para>
         在指定<option>-t</option>时，<application>pg_restore</application>不会尝试恢复所选表可能依赖的任何其他数据库对象。因此，无法确保能成功地把一个特定表恢复到一个干净的数据库中。
        </para>
       </note>

       <note>
        <para>
         这个标志的行为和<application>pg_dump</application>的<option>-t</option>标志不一样。在<application>pg_restore</application>中当前没有任何通配符匹配的规定，也不能在其<option>-t</option>选项中包括模式的名称。而且，虽然<application>pg_dump</application>的<option>-t</option>标志也会转储选中表的附属对象（例如索引），但是<application>pg_restore</application>的<option>-t</option>标志不包括这些附属对象。
        </para>
       </note>

       <note>
        <para>
         在 9.6 版本之前的<productname>PostgreSQL</productname> 9.6 中，这个标志只匹配表，而并不匹配其他类型的关系。
        </para>
       </note>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-T <replaceable class="parameter">trigger</replaceable></option></term>
      <term><option>--trigger=<replaceable class="parameter">trigger</replaceable></option></term>
      <listitem>
       <para>
        只恢复所提及的触发器。可以用多个<option>-T</option>开关指定多个触发器。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-v</option></term>
      <term><option>--verbose</option></term>
      <listitem>
       <para>
        指定冗长模式。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
       <term><option>-V</option></term>
       <term><option>--version</option></term>
       <listitem>
       <para>
       打印该<application>pg_restore</application>的版本并退出。
       </para>
       </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-x</option></term>
      <term><option>--no-privileges</option></term>
      <term><option>--no-acl</option></term>
      <listitem>
       <para>
        阻止恢复访问特权（授予/收回命令）。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-1</option></term>
      <term><option>--single-transaction</option></term>
      <listitem>
       <para>
        将恢复作为单一事务执行（即把发出的命令包裹在<command>BEGIN</command>/<command>COMMIT</command>中）。这可以确保要么所有命令完全成功，要么任何改变都不被应用。这个选项隐含了<option>--exit-on-error</option>。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>--disable-triggers</option></term>
      <listitem>
       <para>
        只有在执行一个只恢复数据的恢复时，这个选项才相关。它指示<application>pg_restore</application>在装载数据时执行命令临时禁用目标表上的触发器。如果你在表上有参照完整性检查或者其他触发器并且你不希望在数据载入期间调用它们时，请使用这个选项。
       </para>

       <para>
        目前，为<option>--disable-triggers</option>发出的命令必须以超级用户身份完成。因此你还应该用<option>-S</option>指定一个超级用户名，或者更好的方法是以一个<productname>PostgreSQL</productname>超级用户运行<application>pg_restore</application>。
       </para>
      </listitem>
     </varlistentry>
     
     <varlistentry>
      <term><option>--enable-row-security</option></term>
      <listitem>
       <para>
        只有在恢复具有行安全性的表的内容时，这个选项才相关。默认情况下，<application>pg_restore</application>将把<xref linkend="guc-row-security"/>设置为 off 来确保所有数据都被恢复到表中。如果用户不拥有足够绕过行安全性的特权，那么会抛出一个错误。这个参数指示<application>pg_restore</application>把<xref linkend="guc-row-security"/>设置为on允许用户尝试恢复启用了行安全性的表的内容。如果用户没有从转储向表中插入行的权限，这仍将失败。
       </para>

       <para>
        注意当前这个选项还要求转储处于<command>INSERT</command>格式，因为<command>COPY FROM</command>不支持行安全性。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>--if-exists</option></term>
      <listitem>
       <para>
        使用条件命令（即增加一个<literal>IF EXISTS</literal>子句）删除数据库对象。只有指定了<option>--clean</option>时，这个选项才有效。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>--no-comments</option></term>
      <listitem>
       <para>
        即便归档中包含注释也不输出恢复注释的命令。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>--no-data-for-failed-tables</option></term>
      <listitem>
       <para>
        默认情况下，即便表的创建命令失败（例如因为表已经存在），表数据也会被恢复。通过这个选项，对这类表的数据会被跳过。如果目标数据库已经包含了想要的表内容，这种行为又很有有用。例如，<productname>PostgreSQL</productname>扩展（如<productname>PostGIS</productname>）的辅助表可能已经被载入到目标数据库中，指定这个选项就能阻止把重复的或者废弃的数据载入到这些表中。
       </para>

       <para>
        只有当直接恢复到一个数据库中时这个选项才有效，在产生 SQL脚本输出时这个选项不会产生效果。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>--no-publications</option></term>
      <listitem>
       <para>
        即便归档中包含publication也不输出恢复publication的命令。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>--no-security-labels</option></term>
      <listitem>
       <para>
        不要输出恢复安全标签的命令，即使归档中包含安全标签。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>--no-subscriptions</option></term>
      <listitem>
       <para>
        即便归档中包含subscription也不输出恢复subscription的命令。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>--no-tablespaces</option></term>
      <listitem>
       <para>
        不输出命令选择表空间。通过这个选项，所有的对象都会被创建在恢复时的默认表空间中。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
       <term><option>--section=<replaceable class="parameter">sectionname</replaceable></option></term>
       <listitem>
         <para>
          只恢复提及的小节。小节的名称可以是<option>pre-data</option>、<option>data</option>或者<option>post-data</option>。可以把这个选项指定多次来选择多个小节。默认值是恢复所有小节。
         </para>
         <para>
          数据小节包含实际的表数据以及大对象定义。Post-data 项由索引定义、触发器、规则和除已验证的检查约束之外的约束构成。Pre-data 项由所有其他数据定义项构成。
         </para>
       </listitem>
     </varlistentry>
     
     <varlistentry>
      <term><option>--strict-names</option></term>
      <listitem>
       <para>
        要求每一个模式（<option>-n</option>/<option>--schema</option>）以及表（<option>-t</option>/<option>--table</option>）限定词匹配备份文件中至少一个模式/表。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>--use-set-session-authorization</option></term>
      <listitem>
       <para>
        输出 SQL 标准的<command>SET SESSION AUTHORIZATION</command>命令取代<command>ALTER OWNER</command>命令来决定对象拥有权。这会让转储更加兼容标准，但是依赖于转储中对象的历史，可能无法正确恢复。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
       <term><option>-?</option></term>
       <term><option>--help</option></term>
       <listitem>
       <para>
       显示有关<application>pg_restore</application>命令行参数的帮助，并且退出。
       </para>
       </listitem>
     </varlistentry>

    </variablelist>
   </para>

<!--==========================orignal english content==========================
   <para>
    <application>pg_restore</application> also accepts
    the following command line arguments for connection parameters:

    <variablelist>
     <varlistentry>
      <term><option>-h <replaceable class="parameter">host</replaceable></option></term>
      <term><option>-&minus;host=<replaceable class="parameter">host</replaceable></option></term>
      <listitem>
       <para>
        Specifies the host name of the machine on which the server is
        running.  If the value begins with a slash, it is used as the
        directory for the Unix domain socket. The default is taken
        from the <envar>PGHOST</envar> environment variable, if set,
        else a Unix domain socket connection is attempted.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-p <replaceable class="parameter">port</replaceable></option></term>
      <term><option>-&minus;port=<replaceable class="parameter">port</replaceable></option></term>
      <listitem>
       <para>
        Specifies the TCP port or local Unix domain socket file
        extension on which the server is listening for connections.
        Defaults to the <envar>PGPORT</envar> environment variable, if
        set, or a compiled-in default.
        </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-U <replaceable>username</replaceable></option></term>
      <term><option>-&minus;username=<replaceable class="parameter">username</replaceable></option></term>
      <listitem>
       <para>
        User name to connect as.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-w</option></term>
      <term><option>-&minus;no-password</option></term>
      <listitem>
       <para>
        Never issue a password prompt.  If the server requires
        password authentication and a password is not available by
        other means such as a <filename>.pgpass</filename> file, the
        connection attempt will fail.  This option can be useful in
        batch jobs and scripts where no user is present to enter a
        password.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-W</option></term>
      <term><option>-&minus;password</option></term>
      <listitem>
       <para>
        Force <application>pg_restore</application> to prompt for a
        password before connecting to a database.
       </para>

       <para>
        This option is never essential, since
        <application>pg_restore</application> will automatically prompt
        for a password if the server demands password authentication.
        However, <application>pg_restore</application> will waste a
        connection attempt finding out that the server wants a password.
        In some cases it is worth typing <option>-W</option> to avoid the extra
        connection attempt.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-&minus;role=<replaceable class="parameter">rolename</replaceable></option></term>
      <listitem>
       <para>
        Specifies a role name to be used to perform the restore.
        This option causes <application>pg_restore</application> to issue a
        <command>SET ROLE</command> <replaceable class="parameter">rolename</replaceable>
        command after connecting to the database. It is useful when the
        authenticated user (specified by <option>-U</option>) lacks privileges
        needed by <application>pg_restore</application>, but can switch to a role with
        the required rights.  Some installations have a policy against
        logging in directly as a superuser, and use of this option allows
        restores to be performed without violating the policy.
       </para>
      </listitem>
     </varlistentry>

    </variablelist>
   </para>
____________________________________________________________________________-->
   <para>
    <application>pg_restore</application>也接受下列用于连接参数的命令行参数：

    <variablelist>
     <varlistentry>
      <term><option>-h <replaceable class="parameter">host</replaceable></option></term>
      <term><option>--host=<replaceable class="parameter">host</replaceable></option></term>
      <listitem>
       <para>
        指定服务器正在运行的机器的主机名。如果该值开始于一个斜线，它被用作一个 Unix 域套接字的目录。默认是从<envar>PGHOST</envar>环境变量中取得（如果被设置），否则将尝试一次 Unix 域套接字连接。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-p <replaceable class="parameter">port</replaceable></option></term>
      <term><option>--port=<replaceable class="parameter">port</replaceable></option></term>
      <listitem>
       <para>
        指定服务器正在监听连接的 TCP 端口或本地 Unix 域套接字文件扩展名。默认是放在<envar>PGPORT</envar>环境变量中（如果被设置），否则使用编译在程序中的默认值。
        </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-U <replaceable>username</replaceable></option></term>
      <term><option>--username=<replaceable class="parameter">username</replaceable></option></term>
      <listitem>
       <para>
        要作为哪个用户连接。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-w</option></term>
      <term><option>--no-password</option></term>
      <listitem>
       <para>
        不发出一个口令提示。如果服务器要求口令认证并且没有其他方式提供口令（例如一个<filename>.pgpass</filename>文件），那么连接尝试将失败。这个选项对于批处理任务和脚本有用，因为在其中没有一个用户来输入口令。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-W</option></term>
      <term><option>--password</option></term>
      <listitem>
       <para>
        强制<application>pg_restore</application>在连接到一个数据库之前提示要求一个口令。
       </para>

       <para>
        这个选项不是必须的，因为如果服务器要求口令认证，<application>pg_restore</application>将自动提示要求一个口令。但是，<application>pg_restore</application>将浪费一次连接尝试来发现服务器想要一个口令。在某些情况下，值得键入<option>-W</option>来避免额外的连接尝试。
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>--role=<replaceable class="parameter">rolename</replaceable></option></term>
      <listitem>
       <para>
        指定一个用来创建该转储的角色名。这个选项导致<application>pg_restore</application>在连接到数据库后发出一个<command>SET ROLE</command> <replaceable class="parameter">rolename</replaceable>命令。当已认证用户（由<option>-U</option>指定）缺少<application>pg_restore</application>所需的特权但是能够切换到一个具有所需权利的角色时，这个选项很有用。一些安装有针对直接作为超级用户登录的策略，使用这个选项可以让转储在不违反该策略的前提下完成。
       </para>
      </listitem>
     </varlistentry>

    </variablelist>
   </para>
 </refsect1>


 <refsect1>
<!--==========================orignal english content==========================
  <title>Environment</title>
____________________________________________________________________________-->
  <title>环境</title>

  <variablelist>
   <varlistentry>
<!--==========================orignal english content==========================
    <term><envar>PGHOST</envar></term>
____________________________________________________________________________-->
    <term><envar>PGHOST</envar></term>
<!--==========================orignal english content==========================
    <term><envar>PGOPTIONS</envar></term>
____________________________________________________________________________-->
    <term><envar>PGOPTIONS</envar></term>
<!--==========================orignal english content==========================
    <term><envar>PGPORT</envar></term>
____________________________________________________________________________-->
    <term><envar>PGPORT</envar></term>
<!--==========================orignal english content==========================
    <term><envar>PGUSER</envar></term>
____________________________________________________________________________-->
    <term><envar>PGUSER</envar></term>

    <listitem>
<!--==========================orignal english content==========================
     <para>
      Default connection parameters
     </para>
____________________________________________________________________________-->
     <para>
      默认连接参数
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

<!--==========================orignal english content==========================
  <para>
   This utility, like most other <productname>PostgreSQL</productname> utilities,
   also uses the environment variables supported by <application>libpq</application>
   (see <xref linkend="libpq-envars"/>).  However, it does not read
   <envar>PGDATABASE</envar> when a database name is not supplied.
  </para>
____________________________________________________________________________-->
  <para>
   和大部分其他<productname>PostgreSQL</productname>工具相似，这个工具也使用<application>libpq</application>（见<xref linkend="libpq-envars"/>）支持的环境变量。
  </para>

 </refsect1>


 <refsect1 id="app-pgrestore-diagnostics">
<!--==========================orignal english content==========================
  <title>Diagnostics</title>
____________________________________________________________________________-->
  <title>诊断</title>

<!--==========================orignal english content==========================
  <para>
   When a direct database connection is specified using the
   <option>-d</option> option, <application>pg_restore</application>
   internally executes <acronym>SQL</acronym> statements. If you have
   problems running <application>pg_restore</application>, make sure
   you are able to select information from the database using, for
   example, <xref linkend="app-psql"/>.  Also, any default connection
   settings and environment variables used by the
   <application>libpq</application> front-end library will apply.
  </para>
____________________________________________________________________________-->
  <para>
   当使用<option>-d</option>选项指定一个直接数据库连接时，<application>pg_restore</application>在内部执行<command>SELECT</command>语句。如果你运行<application>pg_restore</application>时出现问题，确定你能够从正在使用的数据库中选择信息，例如<xref linkend="app-psql"/>。此外，<application>libpq</application>前端-后端库所使用的任何默认连接设置和环境变量都将适用。
  </para>
 </refsect1>


 <refsect1 id="app-pgrestore-notes">
<!--==========================orignal english content==========================
  <title>Notes</title>
____________________________________________________________________________-->
  <title>注解</title>

<!--==========================orignal english content==========================
  <para>
   If your installation has any local additions to the
   <literal>template1</literal> database, be careful to load the output of
   <application>pg_restore</application> into a truly empty database;
   otherwise you are likely to get errors due to duplicate definitions
   of the added objects.  To make an empty database without any local
   additions, copy from <literal>template0</literal> not <literal>template1</literal>, for example:
<programlisting>
CREATE DATABASE foo WITH TEMPLATE template0;
</programlisting>
  </para>
____________________________________________________________________________-->
  <para>
   如果你的数据库集簇对于<literal>template1</literal>数据库有任何本地添加，要注意将<application>pg_restore</application>的输出载入到一个真正的空数据库。否则你很可能由于以增加对象的重复定义而得到错误。要创建一个不带任何本地添加的空数据库，从<literal>template0</literal>而不是<literal>template1</literal>复制它，例如：
<programlisting>
CREATE DATABASE foo WITH TEMPLATE template0;
</programlisting>
  </para>

<!--==========================orignal english content==========================
  <para>
   The limitations of <application>pg_restore</application> are detailed below.

   <itemizedlist>
    <listitem>
     <para>
      When restoring data to a pre-existing table and the option
      <option>-&minus;disable-triggers</option> is used,
      <application>pg_restore</application> emits commands
      to disable triggers on user tables before inserting the data, then emits commands to
      re-enable them after the data has been inserted.  If the restore is stopped in the
      middle, the system catalogs might be left in the wrong state.
     </para>
    </listitem>

    <listitem>
     <para><application>pg_restore</application> cannot restore large objects
      selectively;  for instance, only those for a specific table.  If
      an archive contains large objects, then all large objects will be
      restored, or none of them if they are excluded via <option>-L</option>,
      <option>-t</option>, or other options.
     </para>
    </listitem>

   </itemizedlist>
  </para>
____________________________________________________________________________-->
  <para>
   下面将详细介绍<application>pg_restore</application>的局限性。

   <itemizedlist>
    <listitem>
     <para>
      在恢复数据到一个已经存在的表中并且使用了选项<option>--disable-triggers</option>时，<application>pg_restore</application>会在插入数据之前发出命令禁用用户表上的触发器，然后在完成数据插入后重新启用它们。如果恢复在中途停止，可能会让系统目录处于错误的状态。
     </para>
    </listitem>

    <listitem>
     <para><application>pg_restore</application>不能有选择地恢复大对象，例如只恢复特定表的大对象。如果一个归档包含大对象，那么所有的大对象都会被恢复，如果通过<option>-L</option>、<option>-t</option>或者其他选项进行了排除，它们一个也不会被恢复。
     </para>
    </listitem>

   </itemizedlist>
  </para>

<!--==========================orignal english content==========================
  <para>
   See also the <xref linkend="app-pgdump"/> documentation for details on
   limitations of <application>pg_dump</application>.
  </para>
____________________________________________________________________________-->
  <para>
   <application>pg_dump</application>的局限性详见<xref linkend="app-pgdump"/>文档。
  </para>

<!--==========================orignal english content==========================
  <para>
   Once restored, it is wise to run <command>ANALYZE</command> on each
   restored table so the optimizer has useful statistics; see
   <xref linkend="vacuum-for-statistics"/> and
   <xref linkend="autovacuum"/> for more information.
  </para>
____________________________________________________________________________-->
  <para>
   一旦完成恢复，应该在每一个被恢复的表上运行<command>ANALYZE</command>，这样优化器能得到有用的统计信息。更多信息请见<xref linkend="vacuum-for-statistics"/>和<xref linkend="autovacuum"/>。
  </para>

 </refsect1>


 <refsect1 id="app-pgrestore-examples">
<!--==========================orignal english content==========================
  <title>Examples</title>
____________________________________________________________________________-->
  <title>示例</title>

<!--==========================orignal english content==========================
  <para>
   Assume we have dumped a database called <literal>mydb</literal> into a
   custom-format dump file:

<screen>
<prompt>$</prompt> <userinput>pg_dump -Fc mydb &gt; db.dump</userinput>
</screen>
  </para>
____________________________________________________________________________-->
  <para>
   假设我们已经以自定义格式转储了一个叫做<literal>mydb</literal>的数据库：

<screen>
<prompt>$</prompt> <userinput>pg_dump -Fc mydb &gt; db.dump</userinput>
</screen>
  </para>

<!--==========================orignal english content==========================
  <para>
   To drop the database and recreate it from the dump:

<screen>
<prompt>$</prompt> <userinput>dropdb mydb</userinput>
<prompt>$</prompt> <userinput>pg_restore -C -d postgres db.dump</userinput>
</screen>

   The database named in the <option>-d</option> switch can be any database existing
   in the cluster; <application>pg_restore</application> only uses it to issue the
   <command>CREATE DATABASE</command> command for <literal>mydb</literal>.  With
   <option>-C</option>, data is always restored into the database name that appears
   in the dump file.
  </para>
____________________________________________________________________________-->
  <para>
   要删除该数据库并且从转储中重新创建它：

<screen>
<prompt>$</prompt> <userinput>dropdb mydb</userinput>
<prompt>$</prompt> <userinput>pg_restore -C -d postgres db.dump</userinput>
</screen>

   <option>-d</option>开关中提到的数据库可以是任何已经存在于集簇中的数据库，<application>pg_restore</application>只会用它来为<literal>mydb</literal>发出<command>CREATE DATABASE</command>命令。通过<option>-C</option>，数据总是会被恢复到出现在归档文件的数据库名中。
  </para>

<!--==========================orignal english content==========================
  <para>
   To reload the dump into a new database called <literal>newdb</literal>:

<screen>
<prompt>$</prompt> <userinput>createdb -T template0 newdb</userinput>
<prompt>$</prompt> <userinput>pg_restore -d newdb db.dump</userinput>
</screen>

   Notice we don't use <option>-C</option>, and instead connect directly to the
   database to be restored into.  Also note that we clone the new database
   from <literal>template0</literal> not <literal>template1</literal>, to ensure it is
   initially empty.
  </para>
____________________________________________________________________________-->
  <para>
   要把转储重新载入到一个名为<literal>newdb</literal>的新数据库中：

<screen>
<prompt>$</prompt> <userinput>createdb -T template0 newdb</userinput>
<prompt>$</prompt> <userinput>pg_restore -d newdb db.dump</userinput>
</screen>

   注意我们不使用<option>-C</option>，而是直接连接到要恢复到其中的数据库。还要注意我们是从<literal>template0</literal>而不是<literal>template1</literal>创建了该数据库，以保证它最初是空的。
  </para>

<!--==========================orignal english content==========================
  <para>
   To reorder database items, it is first necessary to dump the table of
   contents of the archive:
<screen>
<prompt>$</prompt> <userinput>pg_restore -l db.dump &gt; db.list</userinput>
</screen>
   The listing file consists of a header and one line for each item, e.g.:
<programlisting>
;
; Archive created at Mon Sep 14 13:55:39 2009
;     dbname: DBDEMOS
;     TOC Entries: 81
;     Compression: 9
;     Dump Version: 1.10-0
;     Format: CUSTOM
;     Integer: 4 bytes
;     Offset: 8 bytes
;     Dumped from database version: 8.3.5
;     Dumped by pg_dump version: 8.3.8
;
;
; Selected TOC Entries:
;
3; 2615 2200 SCHEMA - public pasha
1861; 0 0 COMMENT - SCHEMA public pasha
1862; 0 0 ACL - public pasha
317; 1247 17715 TYPE public composite pasha
319; 1247 25899 DOMAIN public domain0 pasha
</programlisting>
   Semicolons start a comment, and the numbers at the start of lines refer to the
   internal archive ID assigned to each item.
  </para>
____________________________________________________________________________-->
  <para>
   要对数据库项重排序，首先需要转储归档的表内容：
<screen>
<prompt>$</prompt> <userinput>pg_restore -l db.dump &gt; db.list</userinput>
</screen>
   列表文件由一个头部和一些行组成，这些行每一个都用于一个项，例如：
<programlisting>
;
; Archive created at Mon Sep 14 13:55:39 2009
;     dbname: DBDEMOS
;     TOC Entries: 81
;     Compression: 9
;     Dump Version: 1.10-0
;     Format: CUSTOM
;     Integer: 4 bytes
;     Offset: 8 bytes
;     Dumped from database version: 8.3.5
;     Dumped by pg_dump version: 8.3.8
;
;
; Selected TOC Entries:
;
3; 2615 2200 SCHEMA - public pasha
1861; 0 0 COMMENT - SCHEMA public pasha
1862; 0 0 ACL - public pasha
317; 1247 17715 TYPE public composite pasha
319; 1247 25899 DOMAIN public domain0 pasha
</programlisting>
   分号表示开始一段注释，行首的数字表明了分配给每个项的内部归档 ID。
  </para>

<!--==========================orignal english content==========================
  <para>
   Lines in the file can be commented out, deleted, and reordered. For example:
<programlisting>
10; 145433 TABLE map_resolutions postgres
;2; 145344 TABLE species postgres
;4; 145359 TABLE nt_header postgres
6; 145402 TABLE species_records postgres
;8; 145416 TABLE ss_old postgres
</programlisting>
   could be used as input to <application>pg_restore</application> and would only restore
   items 10 and 6, in that order:
<screen>
<prompt>$</prompt> <userinput>pg_restore -L db.list db.dump</userinput>
</screen></para>
____________________________________________________________________________-->
  <para>
   文件中的行可以被注释掉、删除以及重排序。例如：
<programlisting>
10; 145433 TABLE map_resolutions postgres
;2; 145344 TABLE species postgres
;4; 145359 TABLE nt_header postgres
6; 145402 TABLE species_records postgres
;8; 145416 TABLE ss_old postgres
</programlisting>
   把这样一个文件作为<application>pg_restore</application>的输入将会只恢复项 10 和 6，并且先恢复 10 再恢复 6。
<screen>
<prompt>$</prompt> <userinput>pg_restore -L db.list db.dump</userinput>
</screen></para>

 </refsect1>

 <refsect1>
<!--==========================orignal english content==========================
  <title>See Also</title>
____________________________________________________________________________-->
  <title>另见</title>

  <simplelist type="inline">
   <member><xref linkend="app-pgdump"/></member>
   <member><xref linkend="app-pg-dumpall"/></member>
   <member><xref linkend="app-psql"/></member>
  </simplelist>
 </refsect1>
</refentry>
